<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Настройки виджета LEGO Catalog</title>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f3f4f6;
            padding: 20px;
            margin: 0;
        }
        
        .settings-container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .setting-group {
            margin-bottom: 24px;
        }
        
        .setting-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1f2937;
        }
        
        .setting-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .setting-range {
            width: 100%;
        }
        
        .setting-checkbox {
            margin-right: 8px;
        }
        
        .preview {
            background: #1f2937;
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
            color: #f9fafb;
        }
        
        .preview-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .preview-stats {
            display: flex;
            gap: 8px;
        }
        
        .preview-stat {
            background: #374151;
            padding: 8px 12px;
            border-radius: 8px;
            text-align: center;
            flex: 1;
        }
        
        .preview-number {
            font-size: 16px;
            font-weight: 600;
            color: #3b82f6;
        }
        
        .preview-label {
            font-size: 10px;
            color: #9ca3af;
            text-transform: uppercase;
        }
    </style>
</head>
<body>
    <div class="settings-container">
        <h1>Настройки виджета</h1>
        
        <div class="setting-group">
            <label class="setting-label">Тема</label>
            <select id="theme" class="setting-control">
                <option value="default" selected>Стандартный стиль</option>
                <option value="dark">Темная</option>
                <option value="light">Светлая</option>
            </select>
        </div>
        
        <div class="setting-group">
            <label class="setting-label">Прозрачность: <span id="opacity-value">100%</span></label>
            <input type="range" id="opacity" class="setting-range" min="0.1" max="1" step="0.1" value="1">
        </div>
        
        <div class="setting-group">
            <label class="setting-label">Размер виджета</label>
            <select id="size" class="setting-control">
                <option value="2x2">Маленький (2x2)</option>
                <option value="4x2" selected>Средний (4x2)</option>
                <option value="4x4">Большой (4x4)</option>
            </select>
        </div>
        
        <div class="setting-group">
            <label>
                <input type="checkbox" id="compact" class="setting-checkbox">
                Компактный режим
            </label>
        </div>
        
        <div class="setting-group">
            <label>
                <input type="checkbox" id="showThemes" class="setting-checkbox" checked>
                Показывать темы
            </label>
        </div>
        
        <div class="preview" id="preview">
            <div class="preview-title">Предварительный просмотр</div>
            <div class="preview-stats">
                <div class="preview-stat">
                    <div class="preview-number">814</div>
                    <div class="preview-label">Детали</div>
                </div>
                <div class="preview-stat">
                    <div class="preview-number">22</div>
                    <div class="preview-label">Наборы</div>
                </div>
                <div class="preview-stat">
                    <div class="preview-number">33</div>
                    <div class="preview-label">Минифигурки</div>
                </div>
            </div>
        </div>
        
        <button onclick="applySettings()" style="width: 100%; padding: 12px; background: #3b82f6; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; margin-top: 16px;">
            Применить настройки
        </button>
    </div>

    <script>
        // Обновление предварительного просмотра
        function updatePreview() {
            const theme = document.getElementById('theme').value;
            const opacity = document.getElementById('opacity').value;
            const size = document.getElementById('size').value;
            const compact = document.getElementById('compact').checked;
            const showThemes = document.getElementById('showThemes').checked;
            
            const preview = document.getElementById('preview');
            
            // Применяем тему
            if (theme === 'light') {
                preview.style.background = '#f9fafb';
                preview.style.color = '#1f2937';
                preview.querySelectorAll('.preview-stat').forEach(stat => {
                    stat.style.background = '#ffffff';
                    stat.style.border = '1px solid #e5e7eb';
                });
                preview.querySelectorAll('.preview-number').forEach(num => {
                    num.style.color = '#3b82f6';
                });
                preview.querySelectorAll('.preview-label').forEach(label => {
                    label.style.color = '#6b7280';
                });
            } else if (theme === 'default') {
                // Стандартный стиль из сайта
                preview.style.background = '#1f2937';
                preview.style.color = '#d1d5db';
                preview.querySelectorAll('.preview-stat').forEach(stat => {
                    stat.style.background = '#4b5563';
                    stat.style.border = '1px solid #6b7280';
                });
                preview.querySelectorAll('.preview-number').forEach(num => {
                    num.style.color = '#f9fafb';
                });
                preview.querySelectorAll('.preview-label').forEach(label => {
                    label.style.color = '#9ca3af';
                });
            } else {
                // Темная тема
                preview.style.background = '#1f2937';
                preview.style.color = '#f9fafb';
                preview.querySelectorAll('.preview-stat').forEach(stat => {
                    stat.style.background = '#374151';
                    stat.style.border = 'none';
                });
                preview.querySelectorAll('.preview-number').forEach(num => {
                    num.style.color = '#3b82f6';
                });
                preview.querySelectorAll('.preview-label').forEach(label => {
                    label.style.color = '#9ca3af';
                });
            }
            
            // Применяем прозрачность
            preview.style.opacity = opacity;
            
            // Применяем размер
            if (size === '2x2') {
                preview.querySelector('.preview-stats').style.flexDirection = 'column';
                preview.querySelectorAll('.preview-stat').forEach(stat => {
                    stat.style.padding = '6px 8px';
                });
                preview.querySelectorAll('.preview-number').forEach(num => {
                    num.style.fontSize = '12px';
                });
            } else if (size === '4x4') {
                preview.querySelector('.preview-stats').style.flexDirection = 'row';
                preview.querySelectorAll('.preview-stat').forEach(stat => {
                    stat.style.padding = '12px 16px';
                });
                preview.querySelectorAll('.preview-number').forEach(num => {
                    num.style.fontSize = '18px';
                });
            } else {
                preview.querySelector('.preview-stats').style.flexDirection = 'row';
                preview.querySelectorAll('.preview-stat').forEach(stat => {
                    stat.style.padding = '8px 12px';
                });
                preview.querySelectorAll('.preview-number').forEach(num => {
                    num.style.fontSize = '16px';
                });
            }
        }
        
        // Применение настроек
        function applySettings() {
            const settings = {
                theme: document.getElementById('theme').value,
                opacity: parseFloat(document.getElementById('opacity').value),
                size: document.getElementById('size').value,
                compactMode: document.getElementById('compact').checked,
                showThemes: document.getElementById('showThemes').checked
            };
            
            // Отправляем настройки родительскому окну
            if (window.parent && window.parent !== window) {
                window.parent.postMessage({
                    type: 'widgetSettings',
                    settings: settings
                }, '*');
            }
            
            // Сохраняем в localStorage
            localStorage.setItem('legoWidgetSettings', JSON.stringify(settings));
            
            alert('Настройки применены!');
        }
        
        // Загрузка сохраненных настроек
        function loadSettings() {
            const saved = localStorage.getItem('legoWidgetSettings');
            if (saved) {
                try {
                const settings = JSON.parse(saved);
                document.getElementById('theme').value = settings.theme || 'default';
                    document.getElementById('opacity').value = settings.opacity || 1;
                    document.getElementById('size').value = settings.size || '4x2';
                    document.getElementById('compact').checked = settings.compactMode || false;
                    document.getElementById('showThemes').checked = settings.showThemes !== false;
                    updatePreview();
                } catch (error) {
                    console.error('Ошибка загрузки настроек:', error);
                }
            }
        }
        
        // Обновление значения прозрачности
        document.getElementById('opacity').addEventListener('input', function() {
            document.getElementById('opacity-value').textContent = Math.round(this.value * 100) + '%';
            updatePreview();
        });
        
        // Обновление предварительного просмотра при изменении настроек
        document.getElementById('theme').addEventListener('change', updatePreview);
        document.getElementById('size').addEventListener('change', updatePreview);
        document.getElementById('compact').addEventListener('change', updatePreview);
        document.getElementById('showThemes').addEventListener('change', updatePreview);
        
        // Загружаем настройки при загрузке страницы
        document.addEventListener('DOMContentLoaded', loadSettings);
    </script>
</body>
</html>
